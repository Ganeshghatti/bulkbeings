import React, { useRef, useEffect, useLayoutEffect } from "react";
import { useGLTF, useAnimations, useScroll } from "@react-three/drei";
import gsap from "gsap";
import { useFrame } from "@react-three/fiber";

export default function DotsAnimated() {
  const particles = useRef();
  const scroll = useScroll();
  const tl = useRef();

  useEffect(() => {
    console.log(scroll.scroll.current);
  }, [scroll.scroll.current]);

  useFrame(() => {
    if (tl.current) {
      tl.current.seek(scroll.offset * tl.current.duration());
    }
  });

  useLayoutEffect(() => {
    if (particles.current) {
      console.log(particles.current);
      tl.current = gsap.timeline({
        defaults: { duration: 2, ease: "power1.inOut" },
      });
      tl.current
        .to(particles.current, {
          css: { transform: "translateY(100vh)" },
          duration: 5,
        })
        .to(particles.current, {
          css: { transform: "translateY(-100px)" },
          duration: 6,
        })
        .to(particles.current, {
          css: { transform: "translateY(0)" },
          duration: 11,
        });
    } else {
      console.error("GSAP target not found. Ensure ref is attached.");
    }
  }, []);

  return (
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1920 20000">
      <g ref={particles}>
        <path
          fill="none"
          stroke="#000"
          strokeLinejoin="bevel"
          strokeWidth={20.7}
          d="m961.641 537.628-1.827.18-1.756.533-1.619.865-1.419 1.165-1.165 1.419-.865 1.619-.533 1.756-.18 1.827.18 1.826.533 1.757.865 1.619 1.165 1.419 1.419 1.164 1.619.866 1.756.532 1.827.18 1.827-.18 1.756-.532 1.619-.866 1.419-1.164 1.164-1.419.866-1.619.532-1.757.18-1.826-.18-1.827-.533-1.756-.865-1.619-1.164-1.419-1.419-1.165-1.619-.865-1.757-.533-1.826-.18"
        />
      </g>
      <g>
        <path
          fill="none"
          stroke="#000"
          strokeLinejoin="bevel"
          strokeWidth={20.7}
          d="m961.641 537.628-1.827.18-1.756.533-1.619.865-1.419 1.165-1.165 1.419-.865 1.619-.533 1.756-.18 1.827.18 1.826.533 1.757.865 1.619 1.165 1.419 1.419 1.164 1.619.866 1.756.532 1.827.18 1.827-.18 1.756-.532 1.619-.866 1.419-1.164 1.164-1.419.866-1.619.532-1.757.18-1.826-.18-1.827-.533-1.756-.865-1.619-1.164-1.419-1.419-1.165-1.619-.865-1.757-.533-1.826-.18"
        />
      </g>
      <g>
        <path
          fill="none"
          stroke="#000"
          strokeLinejoin="bevel"
          strokeWidth={20.7}
          d="m965.523 529.011-1.827.18-1.756.532-1.619.866-1.419 1.164-1.165 1.419-.865 1.619-.533 1.756-.18 1.827.18 1.827.533 1.756.865 1.619 1.165 1.419 1.419 1.164 1.619.866 1.756.532 1.827.18 1.827-.18 1.756-.532 1.619-.866 1.419-1.164 1.164-1.419.865-1.619.533-1.756.18-1.827-.18-1.827-.533-1.756-.865-1.619-1.164-1.419-1.419-1.164-1.619-.866-1.757-.532-1.826-.18"
        />
      </g>
      <g>
        <path
          fill="none"
          stroke="#000"
          strokeLinejoin="bevel"
          strokeWidth={20.7}
          d="m976.813 506.292-1.826.18-1.757.533-1.618.865-1.419 1.165-1.165 1.418-.865 1.619-.533 1.756-.18 1.827.18 1.827.533 1.756.865 1.619 1.165 1.419 1.419 1.164 1.619.865 1.756.533 1.827.18 1.826-.18 1.757-.533 1.619-.865 1.418-1.164 1.165-1.419.865-1.619.533-1.756.18-1.827-.18-1.827-.533-1.756-.865-1.619-1.165-1.418-1.419-1.165-1.619-.865-1.756-.533-1.827-.18"
        />
      </g>
      <g>
        <path
          fill="none"
          stroke="#000"
          strokeLinejoin="bevel"
          strokeWidth={20.7}
          d="m994.979 474.175-1.826.18-1.757.533-1.618.865-1.419 1.164-1.164 1.419-.866 1.618-.532 1.757-.18 1.826.18 1.827.533 1.756.865 1.619 1.164 1.418 1.419 1.165 1.619.865 1.756.533 1.827.179 1.827-.179 1.756-.533 1.619-.865 1.418-1.165 1.165-1.418.865-1.619.533-1.756.18-1.827-.18-1.826-.533-1.757-.866-1.618-1.164-1.419-1.419-1.164-1.619-.865-1.756-.533-1.827-.18"
        />
      </g>
      <g>
        <path
          fill="none"
          stroke="#000"
          strokeLinejoin="bevel"
          strokeWidth={20.7}
          d="m1019.487 437.36-1.826.18-1.757.532-1.618.866-1.419 1.164-1.164 1.418-.865 1.619-.533 1.756-.18 1.826.18 1.827.533 1.756.865 1.618 1.165 1.419 1.419 1.164 1.618.865 1.757.533 1.826.18 1.827-.18 1.756-.533 1.619-.865 1.419-1.164 1.164-1.419.865-1.618.533-1.756.179-1.827-.18-1.826-.533-1.756-.865-1.619-1.164-1.418-1.419-1.164-1.619-.866-1.756-.532-1.827-.18"
        />
      </g>
      <g>
        <path
          fill="none"
          stroke="#000"
          strokeLinejoin="bevel"
          strokeWidth={20.7}
          d="m1049.804 400.547-1.826.18-1.756.533-1.619.865-1.419 1.164-1.164 1.419-.865 1.618-.532 1.756-.18 1.826.18 1.826.533 1.757.865 1.618 1.165 1.419 1.418 1.164 1.619.865 1.756.532 1.827.18 1.826-.18 1.757-.532 1.618-.865 1.419-1.164 1.164-1.419.865-1.618.532-1.757.18-1.826-.18-1.826-.533-1.756-.865-1.618-1.165-1.419-1.418-1.164-1.619-.865-1.756-.533-1.827-.18"
        />
      </g>
      <g>
        <path
          fill="none"
          stroke="#000"
          strokeLinejoin="bevel"
          strokeWidth={20.7}
          d="m1085.398 368.437-1.827.18-1.756.532-1.618.865-1.419 1.164-1.164 1.419-.865 1.618-.532 1.756-.18 1.826.18 1.826.533 1.756.865 1.618 1.165 1.419 1.418 1.164 1.619.865 1.756.532 1.827.18 1.826-.18 1.756-.532 1.619-.865 1.418-1.164 1.164-1.419.865-1.618.533-1.756.18-1.826-.181-1.826-.533-1.756-.865-1.618-1.164-1.419-1.419-1.164-1.619-.865-1.756-.532-1.826-.18"
        />
      </g>
    </svg>
  );
}
